# Common proxy headers for NodeJS services
proxy_http_version 1.1;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection 'upgrade';
proxy_set_header Host $host;
proxy_cache_bypass $http_upgrade;

# Static images
location /images/ {
    expires 5s;
    root /usr/share/nginx/html;
    try_files $uri /images/placeholder.jpg;
}

# Catalogue service
location /api/catalogue/ {
    proxy_pass http://172.31.17.181:8080/;
}

# Cart service
location /api/cart/ {
    proxy_pass http://172.31.23.96:8080/;
}

# User service (optional, keep if deployed)
location /api/user/ {
    proxy_pass http://172.31.31.134:8080/;
}

# Shipping and Payment (not deployed yet)
location /api/shipping/ {
    proxy_pass http://localhost:8080/;
}

location /api/payment/ {
    proxy_pass http://localhost:8080/;
}

# Nginx health check
location /health {
    stub_status on;
    access_log off;
}
